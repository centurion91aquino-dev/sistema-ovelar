async function guardarProducto() {
    // 1. Obtenemos los valores
    const codInput = document.getElementById('p-cod');
    const nomInput = document.getElementById('p-nom');
    const preInput = document.getElementById('p-pre');
    const stockInput = document.getElementById('p-stock');
    const imgInput = document.getElementById('p-img');

    const prod = {
        codigo: codInput.value,
        nombre: nomInput.value,
        precio: preInput.value,
        stock: stockInput.value,
        imagen_url: imgInput.value
    };

    // Validación simple
    if(!prod.codigo || !prod.nombre) return alert("Por favor completa Código y Nombre");

    try {
        // 2. Enviamos a la base de datos
        const res = await fetch('/guardar-producto', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(prod)
        });

        if (res.ok) {
            alert("✅ Producto guardado correctamente");
            
            // 3. LIMPIAR LOS CUADROS
            codInput.value = '';
            nomInput.value = '';
            preInput.value = '';
            stockInput.value = '';
            imgInput.value = '';

            // 4. ACTUALIZAR LA LISTA AUTOMÁTICAMENTE
            listarProductos();
        } else {
            alert("Error al guardar el producto");
        }
    } catch (error) {
        console.error("Error:", error);
        alert("Hubo un error de conexión");
    }
}
